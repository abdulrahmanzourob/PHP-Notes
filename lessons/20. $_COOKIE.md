## **📌 شرح PHP $_COOKIE واستخدامه**

### **🍪 ما هو الـ Cookie؟**

**Cookie** هو **معلومة تُخزن في متصفح المستخدم**، تُستخدم لتذكر تفضيلاته أو معلومات غير حساسة.  
📌 مثال على استخدامه:

- **تذكر تسجيل الدخول** في موقع ما.
- **حفظ إعدادات اللغة** التي يختارها المستخدم.
- **عرض إعلانات مستهدفة** بناءً على تصفح المستخدم.

---

### **🛠️ 1- إنشاء Cookie في PHP**

🔹 لإنشاء **Cookie** نستخدم دالة `setcookie()` بالشكل التالي:

```php
setcookie("favorite_food", "Pizza", time() + (86400 * 1), "/");
```

💡 **شرح المعاملات:**

|**المعامل**|**الوصف**|
|---|---|
|`"favorite_food"`|اسم الكوكي (المفتاح).|
|`"Pizza"`|القيمة التي سيتم تخزينها.|
|`time() + (86400 * 1)`|مدة صلاحية الكوكي (هنا تنتهي بعد **يوم واحد**).|
|`"/"`|المسار الذي يكون الكوكي متاحًا فيه ("/" تعني في كل الموقع).|

📌 **إضافة أكثر من Cookie:**

```php
setcookie("favorite_drink", "Coffee", time() + (86400 * 3), "/");
setcookie("favorite_dessert", "Ice Cream", time() + (86400 * 4), "/");
```

---

### **🔍 2- عرض جميع الـ Cookies المخزنة**

🔹 يمكننا استخدام `$_COOKIE` لاستعراض جميع الكوكيز المخزنة:

```php
foreach ($_COOKIE as $key => $value) {
    echo "$key = $value <br>";
}
```

📌 **الناتج في المتصفح:**

```
favorite_food = Pizza  
favorite_drink = Coffee  
favorite_dessert = Ice Cream  
```

---

### **🛒 3- استخدام الـ Cookie في الإعلانات أو تخصيص المحتوى**

🔹 يمكننا **استغلال القيم المخزنة في الكوكيز** لتخصيص تجربة المستخدم، مثل عرض إعلان متعلق بأكلته المفضلة:

```php
if (isset($_COOKIE["favorite_food"])) {
    echo "🍕 Buy some " . $_COOKIE["favorite_food"] . " today!";
} else {
    echo "We don't know your favorite food!";
}
```

📌 **الناتج (إذا كان الكوكي محفوظًا):**

```
🍕 Buy some Pizza today!
```

---

### **🗑️ 4- حذف Cookie من المتصفح**

🔹 لحذف Cookie، نُعيد استدعاء `setcookie()` مع تعيين وقت انتهاء الصلاحية إلى **الماضي**:

```php
setcookie("favorite_food", "", time() - 3600, "/"); // حذف الكوكي
```

📌 **بعد تنفيذ هذا الكود، يتم حذف الكوكي من المتصفح.**

---

### **🚀 الفرق بين include و require و include_once**

في بعض الأحيان نحتاج إلى **إدراج ملفات خارجية** في كود PHP، مثل **الهيدر، الفوتر، أو ملف الإعدادات**.

🔹 **📌 include:**  
يستخدم لإدراج ملف، **ولكن إذا لم يكن موجودًا، فسيستمر الكود في التنفيذ مع تحذير.**

```php
include "header.php";
```

🔹 **📌 require:**  
مثل `include`، لكن إذا كان الملف غير موجود، فسيوقف تنفيذ البرنامج تمامًا.

```php
require "config.php";
```

🔹 **📌 include_once / require_once:**  
يضمنان إدراج الملف **مرة واحدة فقط** لتجنب التكرار.

```php
include_once "header.php";
require_once "config.php";
```

---

## **🔥 الخلاصة**

✅ **`$_COOKIE`** تُستخدم لتخزين معلومات في متصفح المستخدم.  
✅ **`setcookie()`** تُنشئ كوكي، ويمكن تحديد مدته ومجاله.  
✅ **`$_COOKIE["key"]`** تُستخدم للوصول إلى الكوكي المخزن.  
✅ **يمكن حذف الكوكي** بإعادة تعيينه مع وقت انتهاء في الماضي.  
✅ **`include` و `require`** تستخدمان لإدراج ملفات خارجية في الكود.

📌 **أفضل الممارسات:**

- لا تستخدم الكوكيز **لتخزين بيانات حساسة** مثل كلمات المرور.
- اجعل مدة صلاحية الكوكي **قصيرة حسب الحاجة**.
- استخدم **`require_once`** لمنع تكرار تحميل الملفات. 🚀
---
# **مثاااااااال
## **1️⃣ إنشاء الكوكيز مع تاريخ انتهاء معين**

```php
$expireTime = time() + (65 * 24 * 60 * 60); // 65 يومًا بالثواني

setcookie("site[color]", "blue", $expireTime, "/", "localhost");
setcookie("site[font]", "Swat", $expireTime, "/", "localhost");
setcookie("site[layout]", "boxed", $expireTime, "/", "localhost");
```

✅ **ما يفعله هذا الجزء:**

- يحسب **وقت انتهاء الكوكيز** ليكون بعد **شهرين و5 أيام (65 يومًا)**.
- ينشئ ثلاثة ملفات كوكيز:
    - `site[color] = blue`
    - `site[font] = Swat`
    - `site[layout] = boxed`
- الكوكيز ستكون صالحة على **المجال (Domain) `localhost`** وعلى **جميع المسارات (`/`)**.

---

## **2️⃣ حذف الكوكيز الخاصة بـ `site[layout]`**

```php
setcookie("site[layout]", "", time() - 3600, "/", "localhost");
```

✅ **لماذا يتم الحذف بهذه الطريقة؟**

- يتم تعيين قيمة فارغة **وانتهاء صلاحية في الماضي** (`time() - 3600`).
- هذا يخبر المتصفح بحذف الكوكيز فورًا.

---

## **3️⃣ إعادة تحميل الصفحة تلقائيًا بعد ضبط الكوكيز**

```php
if (!isset($_GET['reload'])) {
    header("Location: ".$_SERVER['PHP_SELF']."?reload=1");
    exit;
}
```

✅ **لماذا نحتاج لهذا؟**

- عند ضبط الكوكيز باستخدام `setcookie()`، لا تظهر القيم في `$_COOKIE` **مباشرة**، بل تحتاج إلى **إعادة تحميل الصفحة**.
- هذا التحقق يضمن أن الصفحة **تُعاد تحميلها مرة واحدة فقط** بعد ضبط الكوكيز.

---

## **4️⃣ طباعة محتوى الكوكيز بصيغة المصفوفة**

```php
echo "<pre>";
print_r($_COOKIE);
echo "</pre>";
```

✅ **ما يفعله؟**

- يستخدم `print_r($_COOKIE);` لطباعة جميع القيم المخزنة في الكوكيز بشكل مرتب.
- يضعها داخل `<pre>` لتحسين التنسيق.

🔵 **مثال على المخرجات المتوقعة بعد تشغيل الكود:**

```php
Array
(
    [site] => Array
        (
            [color] => blue
            [font] => Swat
        )
)
```

- **لاحظ أن `layout` غير موجودة**، لأنها **تم حذفها** في الخطوة السابقة.

---

## **5️⃣ طباعة رسالة باستخدام بيانات الكوكيز**

```php
if (isset($_COOKIE['site']['color']) && isset($_COOKIE['site']['font'])) {
    $color = $_COOKIE['site']['color'];
    $font = $_COOKIE['site']['font'];
    echo "<p>Your Color Is $color And Your Font Is $font</p>";
} else {
    echo "<p>Cookies are not set properly!</p>";
}
```

✅ **ما يفعله هذا الجزء؟**

- **يتحقق من وجود القيم المطلوبة** في `$_COOKIE`.
- **يستخرج اللون (`color`) والخط (`font`)**، ثم يعرض رسالة:  
    **"Your Color Is blue And Your Font Is Swat"**
- إذا لم تكن القيم مضبوطة، يطبع رسالة خطأ.

---

### **🔴 التعديل المطلوب لجعل الكوكيز تنتهي مع انتهاء الجلسة**

لجعل الكوكيز **تنتهي بانتهاء الجلسة (Session)** بدلًا من أن يكون لها تاريخ انتهاء ثابت، **يجب استخدام `0` بدلًا من `$expireTime`** عند تعيين الكوكيز:

```php
setcookie("site[color]", "blue", 0, "/", "localhost");
setcookie("site[font]", "Swat", 0, "/", "localhost");
```

✅ **بهذه الطريقة، سيتم حذف الكوكيز تلقائيًا عند إغلاق المتصفح.**

---

### **🔥 الخلاصة:**

1. **إنشاء الكوكيز** بثلاثة قيم (`color`, `font`, `layout`) مع صلاحية 65 يومًا.
2. **حذف `site[layout]`** عن طريق ضبط وقت انتهائها في الماضي.
3. **إعادة تحميل الصفحة تلقائيًا (`?reload=1`)** لضمان ظهور القيم في `$_COOKIE`.
4. **طباعة الكوكيز بصيغة المصفوفة**.
5. **إظهار رسالة تحتوي على `color` و `font`** من الكوكيز.
6. **تعديل الكوكيز المتبقية (`color`, `font`) لتصبح مرتبطة بالجلسة (`Session Cookies`)** بحيث تنتهي عند إغلاق المتصفح.

✨ **هل لديك أي استفسارات إضافية؟ 😊**