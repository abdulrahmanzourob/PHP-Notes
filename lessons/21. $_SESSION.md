## **📌 شرح شامل للـ Sessions في PHP**

### **🔹 ما هي الـ Sessions في PHP؟**

الـ **Session** هي طريقة لتخزين بيانات المستخدم **على الخادم (Server-Side)** بدلاً من تخزينها على جهاز المستخدم مثل الكوكيز. تُستخدم للحفاظ على بيانات المستخدم بين الصفحات المختلفة أثناء تصفحه للموقع.

🔹 عندما يتم إنشاء **Session**، يحصل المستخدم على **Session ID** فريد يتم تخزينه مؤقتًا في المتصفح، ويستخدمه الخادم لتحديد المستخدم واسترجاع بياناته.

### **📌 استخدامات الـ Sessions:**

✅ **تسجيل الدخول (Login Sessions)** – تخزين بيانات المستخدم بعد تسجيل الدخول.  
✅ **حفظ بيانات المستخدم بين الصفحات** – مثل بيانات عربة التسوق في متجر إلكتروني.  
✅ **حماية البيانات الحساسة** – لأن البيانات تُخزن على الخادم وليس في المتصفح.  
✅ **إدارة الجلسات المتعددة** – مثل تتبع حالة المستخدم أثناء التنقل في الموقع.

---

## **🔹 إنشاء Session في PHP**

قبل أن نبدأ، **يجب استدعاء دالة `session_start()` في بداية كل صفحة تستخدم الـ Session**.

### **🛠️ مثال على بدء جلسة (Session)**

```php
<?php
session_start(); // بدء الجلسة

$_SESSION["username"] = "Z3rob"; // تخزين اسم المستخدم
$_SESSION["role"] = "Admin"; // تخزين دور المستخدم

echo "مرحبًا، " . $_SESSION["username"];
?>
```

🔹 **`session_start();`**: ضرورية لإنشاء الجلسة أو استئناف جلسة موجودة.  
🔹 **`$_SESSION["username"] = "Z3rob";`**: تخزين بيانات المستخدم في الـ Session.

---

## **🔹 استخدام الـ Sessions بين الصفحات**

بعد تسجيل الدخول، قد تحتاج لاسترجاع البيانات في صفحة أخرى.

### **📤 استرجاع بيانات Session من صفحة أخرى**

```php
<?php
session_start(); // تأكد من استدعائها في كل صفحة تستخدم الجلسة

echo "مرحبًا، " . $_SESSION["username"]; // طباعة اسم المستخدم
?>
```

✅ يمكن الآن للمستخدم التنقل بين الصفحات مع الاحتفاظ ببياناته.

---

## **🔹 إنشاء نظام تسجيل دخول بسيط باستخدام الـ Sessions**

### **📌 الخطوات:**

1️⃣ إنشاء **صفحة تسجيل الدخول** (index.php).  
2️⃣ إنشاء **صفحة رئيسية بعد تسجيل الدخول** (home.php).  
3️⃣ إنشاء **زر تسجيل خروج لإنهاء الجلسة**.

---

### **📝 1️⃣ صفحة تسجيل الدخول (`index.php`)**

🔹 سيتم التحقق من اسم المستخدم وكلمة المرور، ثم تخزينهما في Session.

```php
<?php
session_start(); // بدء الجلسة

if (isset($_POST["login"])) { // التحقق من الضغط على زر تسجيل الدخول
    $username = $_POST["username"];
    $password = $_POST["password"];

    if (!empty($username) && !empty($password)) {
        $_SESSION["username"] = $username;
        $_SESSION["password"] = $password;

        header("Location: home.php"); // توجيه المستخدم إلى الصفحة الرئيسية
        exit();
    } else {
        echo "❌ يرجى إدخال اسم المستخدم وكلمة المرور.";
    }
}
?>

<!DOCTYPE html>
<html>
<head>
    <title>تسجيل الدخول</title>
</head>
<body>
    <form method="post">
        <label>اسم المستخدم:</label>
        <input type="text" name="username">
        <br><br>
        <label>كلمة المرور:</label>
        <input type="password" name="password">
        <br><br>
        <input type="submit" name="login" value="تسجيل الدخول">
    </form>
</body>
</html>
```

🔹 **`isset($_POST["login"])`**: التأكد من الضغط على زر تسجيل الدخول.  
🔹 **`header("Location: home.php");`**: إعادة توجيه المستخدم بعد تسجيل الدخول.

---

### **📝 2️⃣ صفحة الصفحة الرئيسية (`home.php`)**

🔹 ستعرض البيانات المخزنة في الـ Session بعد تسجيل الدخول.

```php
<?php
session_start(); // بدء الجلسة

if (!isset($_SESSION["username"])) {
    header("Location: index.php"); // منع الدخول المباشر وإعادة التوجيه
    exit();
}
?>

<!DOCTYPE html>
<html>
<head>
    <title>الصفحة الرئيسية</title>
</head>
<body>
    <h2>مرحبًا، <?php echo $_SESSION["username"]; ?> 👋</h2>
    <form method="post">
        <input type="submit" name="logout" value="تسجيل الخروج">
    </form>
</body>
</html>
```

🔹 **`if (!isset($_SESSION["username"]))`**: التأكد من تسجيل الدخول، وإلا تتم إعادة التوجيه.  
🔹 **`echo $_SESSION["username"];`**: طباعة اسم المستخدم المسجل.

---

### **📝 3️⃣ زر تسجيل الخروج وإنهاء الجلسة (`home.php`)**

🔹 عند الضغط على زر تسجيل الخروج، سيتم إنهاء الجلسة وإعادة المستخدم لصفحة تسجيل الدخول.

```php
<?php
if (isset($_POST["logout"])) {
    session_unset();  // إزالة جميع البيانات المخزنة
    session_destroy(); // تدمير الجلسة بالكامل

    header("Location: index.php"); // إعادة التوجيه لصفحة تسجيل الدخول
    exit();
}
?>
```

🔹 **`session_unset();`**: حذف جميع القيم المخزنة داخل الـ Session.  
🔹 **`session_destroy();`**: تدمير الجلسة تمامًا، مما يمنع استرجاع القيم.

---

## **🔹 الفرق بين Cookies و Sessions**

|**الميزة**|**Sessions**|**Cookies**|
|---|---|---|
|**مكان التخزين**|على الخادم (Server)|على جهاز المستخدم (Browser)|
|**مدة التخزين**|تستمر حتى إغلاق المتصفح أو انتهاء المهلة|يمكن تحديد مدة طويلة|
|**الأمان**|أكثر أمانًا لأن البيانات لا تُخزن في المتصفح|أقل أمانًا لأنها تُخزن على الجهاز|
|**الحجم المسموح به**|غير محدود نظريًا|حوالي 4KB لكل كوكي|
|**الاستخدام**|تخزين بيانات الجلسة مثل تسجيل الدخول|تذكر بيانات المستخدم مثل الإعدادات|

✅ **يفضل استخدام `Sessions` للأمان العالي عند التعامل مع تسجيل الدخول أو البيانات الحساسة.**  
✅ **يمكن استخدام `Cookies` لتذكر تفضيلات المستخدم مثل الوضع الليلي أو اللغة.**

---

## **📌 ملخص سريع**

✅ **`session_start();`** يجب استدعاؤها في كل صفحة تستخدم الجلسة.  
✅ **`$_SESSION["key"] = value;`** تُستخدم لتخزين القيم داخل الجلسة.  
✅ **`session_unset();` و `session_destroy();`** تُستخدم لحذف وإنهاء الجلسة.  
✅ **`header("Location: page.php");`** تُستخدم لإعادة توجيه المستخدم بعد تسجيل الدخول أو الخروج.  
✅ الفرق بين **Sessions** و **Cookies** يكمن في مكان التخزين ومستوى الأمان.

---

🚀 **بهذا الشرح، يمكنك الآن بناء نظام تسجيل دخول بسيط باستخدام الـ Sessions في PHP!** 💡